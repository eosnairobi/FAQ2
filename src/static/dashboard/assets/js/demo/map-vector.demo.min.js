var handleVectorMap = function () {
        var points = $.ajax({
            type: 'GET',
            url: 'http://127.0.0.1:3000/map/data',
            async: false,
            dataType: 'json',
            done: function (response) {
                return response;
            }
        }).responseJSON;
        console.log(points)
        if (0 !== "#world-map".length) {
            var a = $(window).height();
            $("#world-map").css("height", a), $(window).resize(function () {
                var a = $(window).height();
                $("#world-map").css("height", a)
            }), $("#world-map").vectorMap({
                map: "world_mill_en",
                scaleColors: [COLOR_BLACK_TRANSPARENT_2, COLOR_BLACK_TRANSPARENT_5],
                normalizeFunction: "polynomial",
                hoverOpacity: .5,
                hoverColor: !1,
                markerStyle: {
                    initial: {
                        fill: COLOR_GREEN,
                        stroke: "transparent",
                        r: 6
                    }
                },
                regionStyle: {
                    initial: {
                        fill: COLOR_BLACK_LIGHTER,
                        "fill-opacity": 1,
                        stroke: "none",
                        "stroke-width": .4,
                        "stroke-opacity": 1
                    },
                    hover: {
                        "fill-opacity": .8
                    },
                    selected: {
                        fill: "yellow"
                    },
                    selectedHover: {

                    }
                },
                focusOn: {
                    x: .5,
                    y: .5,
                    scale: 1
                },

                backgroundColor: COLOR_BLACK_DARKER,
                markers: points,

                onMarkerClick: function (event, label, index) {
                    //To create an ajax call that 
                    var markers = $('#world-map').vectorMap('get', 'mapObject').markers;
                    $.ajax({
                            url: '/map/data-filter/',
                            type: 'GET',
                            async: false,
                            dataType: 'json',
                            data: {
                                'id': parseInt(markers[label].config.id)
                            }
                        })
                        .done(function (result) {
                            console.log(result)
                            var dialogDiv = $('<div id="MenuDialog">\
                            <p><b>URL:</b> <a target="_blank" href="' + result[0].url + '">'+result[0].url+'</a>  </p>\
                            <p><b>Email:</b> ' + result[0].email + '  </p>\
                            <p><b>Endpoint:</b> ' + result[0].public_endpoint + '  </p>\
                            </div>');
                            dialogDiv.dialog({
                                modal: true,
                                title: "BP Details - " + result[0].account_name,
                                show: 'clip',
                                hide: 'clip'
                            });
                        })
                        .fail(function () {
                            alert('There was a problem loading data');
                        });
                },
                onMarkerTipShow: function (event, label, index) {
                    var markers = $('#world-map').vectorMap('get', 'mapObject').markers;
                    label.html(label.html() + '<br /><img src="' +
                        markers[index].config.imgsrc +
                        '" height="100" width="100"/>');
                }
            })
        }
    },
    MapVector = function () {
        "use strict";
        return {
            init: function () {
                handleVectorMap()
            }
        }
    }();